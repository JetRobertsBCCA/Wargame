<div id="campaign-tracker-page" class="page">
    <h2>Campaign Tracker</h2>
    <p>Track your commander's progression, XP, unit persistence, and fragment interactions across multiple battles.</p>

    <div class="campaign-header">
        <div>
            <select id="campaign-commander-select" class="commander-select" onchange="updateCampaignCommander()">
                <option value="">-- Select Your Commander --</option>
            </select>
        </div>
        <div class="campaign-actions">
            <button class="btn" onclick="saveCampaign()">ğŸ’¾ Save Campaign</button>
            <button class="btn btn-secondary" onclick="loadCampaign()">ğŸ“‚ Load Campaign</button>
            <button class="btn btn-secondary" onclick="newCampaign()">ğŸ†• New Campaign</button>
        </div>
    </div>

    <div class="dashboard-grid">
        <!-- Commander Status -->
        <div class="card">
            <h3>Commander Status</h3>
            <div id="campaign-commander-info">
                <p style="color: #888;">Select a commander to start tracking.</p>
            </div>
            <div class="level-display">Level <span id="commander-level">1</span></div>
            <div class="xp-container">
                <div class="xp-bar">
                    <div class="xp-fill" id="xp-bar-fill" style="width: 0%"></div>
                    <span class="xp-text"><span id="current-xp">0</span> / <span id="xp-to-level">100</span> XP</span>
                </div>
            </div>
            <div style="margin-top: 1rem;">
                <button class="btn" onclick="addXP(25)" style="font-size: 0.8rem;">+25 XP</button>
                <button class="btn" onclick="addXP(50)" style="font-size: 0.8rem;">+50 XP</button>
                <button class="btn" onclick="addXP(100)" style="font-size: 0.8rem;">+100 XP</button>
            </div>
        </div>

        <!-- Evolution Path Tracker -->
        <div class="card">
            <h3>Evolution Path</h3>
            <div id="evolution-path-tracker">
                <p style="color: #888;">Your skill choices will be tracked here as you level up.</p>
            </div>
            <div id="current-evolution-path" style="margin-top: 1rem;">
                <strong>Current Path:</strong> <span id="path-tendency" style="color: #888;">Undetermined</span>
            </div>
        </div>

        <!-- Campaign Stats -->
        <div class="card">
            <h3>Campaign Statistics</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-value" id="battles-won">0</span>
                    <span class="stat-label">Victories</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="battles-lost">0</span>
                    <span class="stat-label">Defeats</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="battles-drawn">0</span>
                    <span class="stat-label">Draws</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="total-xp-earned">0</span>
                    <span class="stat-label">Total XP</span>
                </div>
            </div>
        </div>

        <!-- Fragment Collection -->
        <div class="card">
            <h3>Active Fragments</h3>
            <div id="active-fragments" class="fragment-tracker">
                <p style="color: #888;">No fragments collected yet.</p>
            </div>
            <div style="margin-top: 1rem;">
                <button class="btn btn-secondary" onclick="openFragmentSelector()" style="width: 100%;">+ Add Fragment</button>
            </div>
        </div>
    </div>

    <!-- Skill Tree Section -->
    <div class="card">
        <h3>Skill Tree Progression</h3>
        <div id="skill-tree-display" class="skill-tree">
            <p style="color: #888; text-align: center;">Select a commander to view their skill tree.</p>
        </div>
    </div>

    <!-- Battle Log -->
    <div class="card">
        <h3>Battle Log</h3>
        <div style="margin-bottom: 1rem;">
            <button class="btn" onclick="recordBattle('victory')">ğŸ† Record Victory</button>
            <button class="btn btn-secondary" onclick="recordBattle('defeat')">ğŸ’€ Record Defeat</button>
            <button class="btn btn-secondary" onclick="recordBattle('draw')">ğŸ¤ Record Draw</button>
        </div>
        <div id="battle-log" class="battle-log">
            <p style="color: #888; text-align: center;">No battles recorded yet. Start your campaign!</p>
        </div>
    </div>

    <!-- Unit Persistence -->
    <div class="card">
        <h3>Unit Persistence Tracker</h3>
        <p style="color: #888; font-size: 0.9rem;">Track damage, buffs, and mutations that persist across battles.</p>
        <div id="persistent-units">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="border-bottom: 2px solid #0f3460;">
                        <th style="text-align: left; padding: 0.5rem;">Unit Name</th>
                        <th style="text-align: center; padding: 0.5rem;">Status</th>
                        <th style="text-align: center; padding: 0.5rem;">Buffs</th>
                        <th style="text-align: center; padding: 0.5rem;">Mutations</th>
                        <th style="text-align: center; padding: 0.5rem;">Actions</th>
                    </tr>
                </thead>
                <tbody id="unit-tracker-body">
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 1rem; color: #888;">Add units to track their campaign progression</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div style="margin-top: 1rem;">
            <button class="btn btn-secondary" onclick="addPersistentUnit()">+ Add Unit to Tracker</button>
        </div>
    </div>

    <!-- Level Up Modal (hidden by default) -->
    <div id="levelup-modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 1000; display: none; align-items: center; justify-content: center;">
        <div class="card" style="max-width: 600px; margin: 2rem;">
            <h3>ğŸ‰ Level Up!</h3>
            <p>Your commander has reached a new level! Choose your skill upgrade:</p>
            <div id="levelup-choices" class="evolution-grid">
                <!-- Choices loaded dynamically -->
            </div>
        </div>
    </div>
</div>
